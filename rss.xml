import json
from datetime import datetime

BASE_URL = "https://mp3wisdom.github.io/unifiedwisdompodcast/"

with open("metadata.json", "r", encoding="utf-8") as f:
    episodes = json.load(f)

rss = f'''<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:itunes="http://www.itunes.com/dtds/podcast-1.0.dtd">
<channel>
  <title>Unified Wisdom Podcast</title>
  <link>{BASE_URL}</link>
  <description>Exploring stories, reflections, and wisdom</description>
  <language>en-us</language>
  <itunes:author>Kishore</itunes:author>
  <itunes:explicit>false</itunes:explicit>
  <itunes:category text="Society & Culture"/>
  <itunes:image href="{BASE_URL}cover.png"/>
'''

for ep in episodes:
    rss += f"""
  <item>
    <title>{ep['title']}</title>
    <description>{ep['description']}</description>
    <pubDate>{ep['pubDate']}</pubDate>
    <enclosure url="{BASE_URL}{ep['file']}" length="{ep['length']}" type="audio/mpeg"/>
    <guid>{BASE_URL}{ep['file']}</guid>
    <itunes:duration>{ep['duration']}</itunes:duration>
  </item>
"""

rss += """
</channel>
</rss>
"""

with open("rss.xml", "w", encoding="utf-8") as f:
    f.write(rss)
